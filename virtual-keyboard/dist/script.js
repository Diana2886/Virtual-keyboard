(()=>{"use strict";function e(e,t,i,s,...h){let y=null;return y=document.createElement(e),t&&y.classList.add(...t.split(" ")),i&&Array.isArray(i)?i.forEach((e=>y.append(e))):i&&"object"==typeof i?y.append(i):i&&"string"==typeof i&&(y.innerHTML=i),s&&s.append(y),h.length&&h.forEach((([e,t])=>{""===t?y.setAttribute(e,""):e.match(/value|id|placeholder|cols|rows|autocorrect|spellcheck/)?y.setAttribute(e,t):y.dataset[e]=t})),y}const t={ru:[{key:"ё",shift:"Ё",code:"Backquote"},{key:"1",shift:"!",code:"Digit1"},{key:"2",shift:'"',code:"Digit2"},{key:"3",shift:"№",code:"Digit3"},{key:"4",shift:";",code:"Digit4"},{key:"5",shift:"%",code:"Digit5"},{key:"6",shift:":",code:"Digit6"},{key:"7",shift:"?",code:"Digit7"},{key:"8",shift:"*",code:"Digit8"},{key:"9",shift:"(",code:"Digit9"},{key:"0",shift:")",code:"Digit0"},{key:"-",shift:"_",code:"Minus"},{key:"=",shift:"+",code:"Equal"},{key:"Backspace",shift:null,code:"Backspace"},{key:"Delete",shift:null,code:"Delete"},{key:"Tab",shift:null,code:"Tab"},{key:"й",shift:"Й",code:"KeyQ"},{key:"ц",shift:"Ц",code:"KeyW"},{key:"у",shift:"У",code:"KeyE"},{key:"к",shift:"К",code:"KeyR"},{key:"е",shift:"Е",code:"KeyT"},{key:"н",shift:"Н",code:"KeyY"},{key:"г",shift:"Г",code:"KeyU"},{key:"ш",shift:"Ш",code:"KeyI"},{key:"щ",shift:"Щ",code:"KeyO"},{key:"з",shift:"З",code:"KeyP"},{key:"х",shift:"Х",code:"BracketLeft"},{key:"ъ",shift:"Ъ",code:"BracketRight"},{key:"Enter",shift:null,code:"Enter"},{key:"CapsLock",shift:null,code:"CapsLock"},{key:"ф",shift:"Ф",code:"KeyA"},{key:"ы",shift:"Ы",code:"KeyS"},{key:"в",shift:"В",code:"KeyD"},{key:"а",shift:"А",code:"KeyF"},{key:"п",shift:"П",code:"KeyG"},{key:"р",shift:"Р",code:"KeyH"},{key:"о",shift:"О",code:"KeyJ"},{key:"л",shift:"Л",code:"KeyK"},{key:"д",shift:"Д",code:"KeyL"},{key:"ж",shift:"Ж",code:"Semicolon"},{key:"э",shift:"Э",code:"Quote"},{key:"\\",shift:"/",code:"Backslash"},{key:"Shift",shift:null,code:"ShiftLeft"},{key:"я",shift:"Я",code:"KeyZ"},{key:"ч",shift:"Ч",code:"KeyX"},{key:"с",shift:"С",code:"KeyC"},{key:"м",shift:"М",code:"KeyV"},{key:"и",shift:"И",code:"KeyB"},{key:"т",shift:"Т",code:"KeyN"},{key:"ь",shift:"Ь",code:"KeyM"},{key:"б",shift:"Б",code:"Comma"},{key:"ю",shift:"Ю",code:"Period"},{key:".",shift:",",code:"Slash"},{key:"Shift",shift:null,code:"ShiftRight"},{key:"Ctrl",shift:null,code:"ControlLeft"},{key:"Alt",shift:null,code:"AltLeft"},{key:" ",shift:null,code:"Space"},{key:"Alt",shift:null,code:"AltRight"},{key:"Ctrl",shift:null,code:"ControlRight"},{key:"&larr;",shift:null,code:"ArrowLeft"},{key:"&uarr;",shift:null,code:"ArrowUp"},{key:"&darr;",shift:null,code:"ArrowDown"},{key:"&rarr;",shift:null,code:"ArrowRight"},{key:"Ru",shift:null,code:"Lang"}],en:[{key:"`",shift:"~",code:"Backquote"},{key:"1",shift:"!",code:"Digit1"},{key:"2",shift:"@",code:"Digit2"},{key:"3",shift:"#",code:"Digit3"},{key:"4",shift:"$",code:"Digit4"},{key:"5",shift:"%",code:"Digit5"},{key:"6",shift:"^",code:"Digit6"},{key:"7",shift:"&",code:"Digit7"},{key:"8",shift:"*",code:"Digit8"},{key:"9",shift:"(",code:"Digit9"},{key:"0",shift:")",code:"Digit0"},{key:"-",shift:"_",code:"Minus"},{key:"=",shift:"+",code:"Equal"},{key:"Backspace",shift:null,code:"Backspace"},{key:"Delete",shift:null,code:"Delete"},{key:"Tab",shift:null,code:"Tab"},{key:"q",shift:"Q",code:"KeyQ"},{key:"w",shift:"W",code:"KeyW"},{key:"e",shift:"E",code:"KeyE"},{key:"r",shift:"R",code:"KeyR"},{key:"t",shift:"T",code:"KeyT"},{key:"y",shift:"Y",code:"KeyY"},{key:"u",shift:"U",code:"KeyU"},{key:"i",shift:"I",code:"KeyI"},{key:"o",shift:"O",code:"KeyO"},{key:"p",shift:"P",code:"KeyP"},{key:"[",shift:"{",code:"BracketLeft"},{key:"]",shift:"}",code:"BracketRight"},{key:"Enter",shift:null,code:"Enter"},{key:"CapsLock",shift:null,code:"CapsLock"},{key:"a",shift:"A",code:"KeyA"},{key:"s",shift:"S",code:"KeyS"},{key:"d",shift:"D",code:"KeyD"},{key:"f",shift:"F",code:"KeyF"},{key:"g",shift:"G",code:"KeyG"},{key:"h",shift:"H",code:"KeyH"},{key:"j",shift:"J",code:"KeyJ"},{key:"k",shift:"K",code:"KeyK"},{key:"l",shift:"L",code:"KeyL"},{key:";",shift:":",code:"Semicolon"},{key:"'",shift:'"',code:"Quote"},{key:"\\",shift:"|",code:"Backslash"},{key:"Shift",shift:null,code:"ShiftLeft"},{key:"z",shift:"Z",code:"KeyZ"},{key:"x",shift:"X",code:"KeyX"},{key:"c",shift:"C",code:"KeyC"},{key:"v",shift:"V",code:"KeyV"},{key:"b",shift:"B",code:"KeyB"},{key:"n",shift:"N",code:"KeyN"},{key:"m",shift:"M",code:"KeyM"},{key:",",shift:"<",code:"Comma"},{key:".",shift:">",code:"Period"},{key:"/",shift:"?",code:"Slash"},{key:"Shift",shift:null,code:"ShiftRight"},{key:"Ctrl",shift:null,code:"ControlLeft"},{key:"Alt",shift:null,code:"AltLeft"},{key:" ",shift:null,code:"Space"},{key:"Alt",shift:null,code:"AltRight"},{key:"Ctrl",shift:null,code:"ControlRight"},{key:"&larr;",shift:null,code:"ArrowLeft"},{key:"&uarr;",shift:null,code:"ArrowUp"},{key:"&darr;",shift:null,code:"ArrowDown"},{key:"&rarr;",shift:null,code:"ArrowRight"},{key:"En",shift:null,code:"Lang"}]};class i{constructor({key:t,shift:i,code:s}){this.key=t,this.shift=i,this.code=s,this.isFnKey=Boolean(t.match(/Tab|Caps|Shift|Ctrl|Alt|Enter|Back|Del|arr|En|Ru/)),i&&i.match(/[^0-9a-zA-Zа-яА-ЯёЁ]/)?this.keyShift=e("div","key-shift",this.shift):this.keyShift=e("div","key-shift",""),this.keyTitle=e("div","key-title",t),this.keyContainer=e("div","keyboard__key",[this.keyShift,this.keyTitle],null,["code",this.code],this.isFnKey?["fn","true"]:["fn","false"])}}const s=e("div","wrapper",[e("h1","title","RSS Virtual Keyboard")]),h=function(e,t=null){return window.localStorage.getItem(e)||t}("lang","en");new class{constructor(e){this.keyboardRows=e,this.keyPressed={},this.isCaps=!1}init(i){return this.keyBase=t[i],this.display=e("textarea","display",null,s,["placeholder","Hello!\nThe keyboard was created in the Windows OS\nUse the left Ctrl + Alt (or a special button) to switch the language"],["rows",10],["cols",50]),this.container=e("div","keyboard",null,s,["lang",i]),document.body.prepend(s),this}generateLayout(){this.keyButtons=[],this.keyboardRows.forEach(((t,s)=>{const h=e("div","keyboard__row",null,this.container,["row",s+1]);t.forEach((e=>{const t=this.keyBase.find((t=>t.code===e));if(t){const e=new i(t);this.keyButtons.push(e),h.append(e.keyContainer)}}))})),document.addEventListener("keydown",this.handleEvent),document.addEventListener("keyup",this.handleEvent),this.container.addEventListener("mousedown",this.preHandleEvent),this.container.addEventListener("mouseup",this.preHandleEvent)}preHandleEvent=e=>{e.stopPropagation();const t=e.target.closest(".keyboard__key");if(!t)return;const{dataset:{code:i}}=t;t.addEventListener("mouseleave",this.resetButtonState),this.handleEvent({code:i,type:e.type})};resetButtonState=({target:{dataset:{code:e}}})=>{const t=this.keyButtons.find((t=>t.code===e));this.isCaps||t.keyContainer.classList.remove("active"),t.keyContainer.removeEventListener("mouseleave",this.resetButtonState)};handleEvent=e=>{e.stopPropagation&&e.stopPropagation();const{code:t,type:i}=e,s=this.keyButtons.find((e=>e.code===t));s&&(this.display.focus(),i.match(/keydown|mousedown/)?(i.match(/key/)&&e.preventDefault(),s.keyContainer.classList.add("active"),t.match(/Shift/)&&(this.shiftKey=!0),this.shiftKey&&this.switchToUpperCase(!0),t.match(/Caps/)&&!this.isCaps?(this.isCaps=!0,this.switchToUpperCase(!0)):t.match(/Caps/)&&this.isCaps&&(this.isCaps=!1,this.switchToUpperCase(!1),s.keyContainer.classList.remove("active")),t.match(/Control/)&&(this.ctrlKey=!0),t.match(/Alt/)&&(this.altKey=!0),t.match(/Control/)&&this.altKey&&this.changeLang(),t.match(/Alt/)&&this.ctrlKey&&this.changeLang(),this.isCaps?this.isCaps&&(this.shiftKey?this.printToDisplay(s,s.keyShift.innerHTML?s.shift:s.key):this.printToDisplay(s,s.keyShift.innerHTML?s.key:s.shift)):this.printToDisplay(s,this.shiftKey?s.shift:s.key)):i.match(/keyup|mouseup/)&&(t.match(/Shift/)&&(this.shiftKey=!1,this.switchToUpperCase(!1)),t.match(/Control/)&&(this.ctrlKey=!1),t.match(/Alt/)&&(this.altKey=!1),t.match(/Caps/)||s.keyContainer.classList.remove("active")))};changeLang=()=>{const e=Object.keys(t);let i=e.indexOf(this.container.dataset.lang);var s;this.keyBase=i+1<e.length?t[e[i+=1]]:t[e[i-=i]],this.container.dataset.lang=e[i],s=e[i],window.localStorage.setItem("lang",s),this.keyButtons.forEach((e=>{const t=e,i=this.keyBase.find((t=>t.code===e.code));i&&(t.shift=i.shift,t.key=i.key,i.shift&&i.shift.match(/[^0-9a-zA-Zа-яА-ЯёЁ]/g)?t.keyShift.innerHTML=i.shift:t.keyShift.innerHTML="",t.keyTitle.innerHTML=i.key)})),this.isCaps&&this.switchToUpperCase(!0)};switchToUpperCase(e){e?this.keyButtons.forEach((e=>{const t=e;t.keyShift&&this.shiftKey&&(t.keyShift.classList.add("key-shift_active"),t.keyTitle.classList.add("key-shift_inactive")),t.isFnKey||!this.isCaps||this.shiftKey||t.keyShift.innerHTML?!t.isFnKey&&this.isCaps&&this.shiftKey?t.keyTitle.innerHTML=t.key:t.isFnKey||t.keyShift.innerHTML||(t.keyTitle.innerHTML=t.shift):t.keyTitle.innerHTML=t.shift})):this.keyButtons.forEach((e=>{const t=e;t.keyShift.innerHTML&&!t.isFnKey?(t.keyShift.classList.remove("key-shift_active"),t.keyTitle.classList.remove("key-shift_inactive"),this.isCaps||(t.keyTitle.innerHTML=t.key)):t.isFnKey||(this.isCaps?t.keyTitle.innerHTML=t.shift:t.keyTitle.innerHTML=t.key)}))}printToDisplay(e,t){let i=this.display.selectionStart;const s=this.display.value.slice(0,i),h=this.display.value.slice(i),y={Tab:()=>{this.display.value=`${s}\t${h}`,i+=1},ArrowLeft:()=>{i=i-1>=0?i-1:0},ArrowRight:()=>{i+=1},ArrowUp:()=>{const e=this.display.value.slice(0,i).match(/(\n).*$/g)||[],t=this.display.value.slice(0,i).match(/.*(\n).*$/g)||[];if(t[0]){const s=t[0].length-e[0].length;i-=s>=e[0].length?t[0].length-e[0].length+1:e[0].length}},ArrowDown:()=>{const e=this.display.value.slice(i).match(/^.*(\n)/)||[],t=this.display.value.slice(0,i).match(/.*$/)||[],s=this.display.value.slice(i).match(/(\n).*/)||[];e[0]&&(i+=t[0].length<=s[0].length-1?e[0].length+t[0].length:e[0].length+s[0].length-1)},Enter:()=>{this.display.value=`${s}\n${h}`,i+=1},Delete:()=>{if(this.display.selectionEnd-this.display.selectionStart>1){const e=this.display.value.slice(this.display.selectionStart,this.display.selectionEnd).length;this.display.value=`${s}${h.slice(e)}`}else this.display.value=`${s}${h.slice(1)}`},Backspace:()=>{if(this.display.selectionEnd-this.display.selectionStart>1){const e=this.display.value.slice(this.display.selectionStart,this.display.selectionEnd).length;this.display.value=`${s}${h.slice(e)}`}else this.display.value=`${s.slice(0,-1)}${h}`,i-=1},Space:()=>{this.display.value=`${s} ${h}`,i+=1},Lang:()=>{this.changeLang()}};if(y[e.code])y[e.code]();else if(!e.isFnKey)if(this.display.selectionEnd-this.display.selectionStart>1){const e=this.display.value.slice(this.display.selectionStart,this.display.selectionEnd).length;this.display.value=`${s}${t||""}${h.slice(e)}`,i+=1}else i+=1,this.display.value=`${s}${t||""}${h}`;this.display.setSelectionRange(i,i)}}([["Backquote","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","Backspace"],["Tab","KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","IntlBackslash","Backslash","Delete"],["CapsLock","KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","Enter"],["ShiftLeft","KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash","ArrowUp","ShiftRight"],["ControlLeft","Lang","AltLeft","Space","AltRight","ArrowLeft","ArrowDown","ArrowRight","ControlRight"]]).init(h).generateLayout()})();
//# sourceMappingURL=script.js.map